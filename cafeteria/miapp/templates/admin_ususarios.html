{% extends "base.html" %}
{% load static %}
{% block title %}Administrador - Aroma Celestial {% endblock %}
{% block content %}
<h1>Lista de Usuarios</h1>
<table class="table table-striped">
  <thead>
    <tr>
      <th>Username</th>
      <th>Nombre</th>
      <th>Apellido</th>
      <th>Email</th>
      <th>Grupos Actuales</th>
      <th>Cambiar Grupo</th>
    </tr>
  </thead>
  <tbody>
    {% for usuario in usuarios %}
      <tr>
        <td>{{ usuario.username }}</td>
        <td>{{ usuario.first_name }}</td>
        <td>{{ usuario.last_name }}</td>
        <td>{{ usuario.email }}</td>
        <td>
          {% for grupo in usuario.groups.all %}
            {{ grupo.name }}{% if not forloop.last %}, {% endif %}
          {% endfor %}
        </td>
        <td>
          <form method="post" style="display: inline;">
            {% csrf_token %}
            <input type="hidden" name="usuario_id" value="{{ usuario.id }}">
            {{ cambiar_grupo_form.grupo }}
            <button type="submit" class="btn btn-sm btn-primary">Cambiar</button>
          </form>
        </td>
      </tr>
    {% endfor %}
  </tbody>
</table>
{% if is_paginated %}
  <div class="pagination">
    <span class="step-links">
      {% if page_obj.has_previous %}
        <a href="?page=1">&laquo; primera</a>
        <a href="?page={{ page_obj.previous_page_number }}">anterior</a>
      {% endif %}

      <span class="current">
        Página {{ page_obj.number }} de {{ page_obj.paginator.num_pages }}.
      </span>

      {% if page_obj.has_next %}
        <a href="?page={{ page_obj.next_page_number }}">siguiente</a>
        <a href="?page={{ page_obj.paginator.num_pages }}">última &raquo;</a>
      {% endif %}
    </span>
  </div>
{% endif %}
<!-- Mensajes de éxito/error -->
{% if messages %}
  {% for message in messages %}
    <div class="alert alert-{{ message.tags }}">
      {{ message }}
    </div>
  {% endfor %}
{% endif %}
{% endblock %}